import json

def filtered_vulnerability(filter,value):

    # File di input (JSON originale)
    input_file = "data/scan_results.json"

    # File di output (solo oggetti con severity == 4)
    output_file = "data/scan_results_filtered.json"

    # Carica i dati dal file originale
    with open(input_file, "r", encoding="utf-8") as f:
        dati = json.load(f)

    # Filtra gli elementi con severity == 4
    filtrati = [item for item in dati if item.get(filter) == value]

    # Salva i risultati filtrati nel nuovo file
    with open(output_file, "w", encoding="utf-8") as f:
        json.dump(filtrati, f, indent=4, ensure_ascii=False)
